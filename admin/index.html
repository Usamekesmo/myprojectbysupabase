<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة تحكم المشرف</title>
    <link rel="stylesheet" href="admin.css">
</head>
<body>
    <div class="container">
        <!-- شاشة تسجيل الدخول -->
        <div id="login-screen">
            <h1>تسجيل دخول المشرف</h1>
            <input type="email" id="admin-email" placeholder="البريد الإلكتروني" required>
            <input type="password" id="admin-password" placeholder="كلمة المرور" required>
            <button id="admin-login-button">تسجيل الدخول</button>
            <p id="login-error" class="error-message"></p>
        </div>

        <!-- لوحة التحكم الرئيسية (مخفية افتراضيًا) -->
        <div id="dashboard-screen" class="hidden">
            <header>
                <h1>لوحة التحكم</h1>
                <button id="logout-button">تسجيل الخروج</button>
            </header>

            <!-- قسم الإحصائيات -->
            <section id="stats-section">
                <h2>نظرة عامة</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>إجمالي اللاعبين</h3>
                        <p id="total-players-stat">...</p>
                    </div>
                    <div class="stat-card">
                        <h3>إجمالي الاختبارات</h3>
                        <p id="total-quizzes-stat">...</p>
                    </div>
                    <div class="stat-card">
                        <h3>متوسط النقاط</h3>
                        <p id="average-score-stat">...</p>
                    </div>
                </div>
            </section>

            <!-- قسم إدارة اللاعبين -->
            <section id="player-management-section">
                <h2>إدارة اللاعبين</h2>
                <input type="text" id="player-search" placeholder="ابحث عن لاعب بالاسم...">
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>الاسم</th>
                            <th>البريد الإلكتروني</th>
                            <th>الخبرة (XP)</th>
                            <th>الألماس</th>
                            <th>تاريخ الانضمام</th>
                            <!-- ▼▼▼ الإضافة هنا ▼▼▼ -->
                            <th>إجراءات</th>
                        </tr>
                    </thead>
                    <tbody id="players-table-body">
                        <!-- سيتم ملء الصفوف هنا بواسطة JavaScript -->
                    </tbody>
                </table>
            </section>

            <!-- قسم إدارة المتجر -->
            <section id="store-management-section">
                <h2>إدارة المتجر</h2>
                <div class="store-management-grid">
                    <div class="store-list">
                        <h3>العناصر الحالية</h3>
                        <ul id="store-items-list">
                            <!-- سيتم ملء العناصر هنا -->
                        </ul>
                    </div>
                    <div class="add-item-form">
                        <h3>إضافة عنصر جديد</h3>
                        <input type="text" id="item-id" placeholder="معرف العنصر (e.g., page_605)">
                        <input type="text" id="item-name" placeholder="اسم العنصر (e.g., شراء صفحة 605)">
                        <textarea id="item-description" placeholder="وصف العنصر"></textarea>
                        <input type="number" id="item-price" placeholder="السعر (بالألماس)">
                        <select id="item-type">
                            <option value="page">صفحة</option>
                            <option value="qari">قارئ</option>
                            <option value="theme">سمة</option>
                            <option value="xp_exchange">استبدال خبرة</option>
                        </select>
                        <input type="text" id="item-value" placeholder="قيمة العنصر (e.g., 605 للصفحة)">
                        <input type="number" id="item-sort-order" placeholder="ترتيب العرض">
                        <button id="add-item-button">إضافة العنصر للمتجر</button>
                    </div>
                </div>
            </section>

            <!-- ▼▼▼ النافذة المنبثقة لتعديل اللاعب (جديدة بالكامل) ▼▼▼ -->
            <div id="edit-player-modal" class="modal hidden">
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <h2>تعديل بيانات اللاعب</h2>
                    <input type="hidden" id="edit-player-id">
                    <div class="form-group">
                        <label for="edit-player-username">اسم المستخدم:</label>
                        <input type="text" id="edit-player-username">
                    </div>
                    <div class="form-group">
                        <label for="edit-player-xp">نقاط الخبرة (XP):</label>
                        <input type="number" id="edit-player-xp">
                    </div>
                    <div class="form-group">
                        <label for="edit-player-diamonds">الألماس:</label>
                        <input type="number" id="edit-player-diamonds">
                    </div>
                    <button id="save-player-changes-button">حفظ التغييرات</button>
                </div>
            </div>
            <!-- ▲▲▲ نهاية النافذة المنبثقة ▲▲▲ -->

                </div>
    </div>
    
    <!-- ▼▼▼ هذا هو السطر المفقود الذي يجب إضافته ▼▼▼ -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <script type="module" src="../config.js"></script>
    <script type="module" src="admin.js"></script>
</body>
</html>


